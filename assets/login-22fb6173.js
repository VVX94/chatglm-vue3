import{d as I,u as C,r as i,a as f,b as s,c as F,e,w as o,o as S,f as g,E as U,g as T,h as w,p as B,i as E,j as L}from"./index-8efee50f.js";import{_ as N}from"./_plugin-vue_export-helper-c27b6911.js";const R=n=>(B("data-v-52dcd575"),n=n(),E(),n),q={class:"cont"},z=R(()=>L("h3",{class:"title"},"👉 登录 👈",-1)),j=I({__name:"login",setup(n){const h=C(),m=i(),_=i(!1);i("");const a=f({username:"",password:""}),x=f({username:[{required:!0,message:"用户名不能为空",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"}]}),v=d=>{d&&d.validate(t=>{if(t){const p=U.service({lock:!0,text:"拼命加载中...",background:"rgba(0, 0, 0, 0.7)"});setTimeout(()=>{p.close()},1500),_.value=!0;const l={url:"https://glmapi.gaozih.top/api/user/token/get/",data:{username:a.username,password:a.password},method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"}};T(l).then(r=>{localStorage.setItem("access",r.data.access),localStorage.setItem("refresh",r.data.refresh),w({message:"登录成功！",type:"success"}),h.push("index")}).catch(r=>{console.error(r),w({message:"账号密码错误！",type:"warning"})})}else return console.log("error submit!"),!1})};return(d,t)=>{const p=s("User"),l=s("el-icon"),r=s("el-input"),u=s("el-form-item"),y=s("Lock"),b=s("router-link"),k=s("el-button"),V=s("el-form");return S(),F("div",q,[e(V,{ref_key:"ruleFormRef",ref:m,model:a,rules:x,class:"login-form","status-icon":""},{default:o(()=>[z,e(u,{prop:"username"},{default:o(()=>[e(r,{class:"input-with-select",modelValue:a.username,"onUpdate:modelValue":t[0]||(t[0]=c=>a.username=c),placeholder:"用户名",clearable:""},{prefix:o(()=>[e(l,null,{default:o(()=>[e(p)]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(u,{prop:"password"},{default:o(()=>[e(r,{type:"password",clearable:"",placeholder:"密码",modelValue:a.password,"onUpdate:modelValue":t[1]||(t[1]=c=>a.password=c),class:"input-with-select"},{prefix:o(()=>[e(l,null,{default:o(()=>[e(y)]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(b,{to:"/reg",style:{"text-decoration":"none",padding:"10px",color:"#4e89ff","font-size":"15px"}},{default:o(()=>[g(" 没有账号，快去注册 ")]),_:1}),e(u,{style:{"margin-top":"10px"}},{default:o(()=>[e(k,{loading:_.value,type:"primary",onClick:t[2]||(t[2]=c=>v(m.value)),style:{width:"100%"}},{default:o(()=>[g("登录")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"])])}}});const A=N(j,[["__scopeId","data-v-52dcd575"]]);export{A as default};
